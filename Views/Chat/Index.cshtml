@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
@{
    ViewData["Title"] = "Chat with Doctor";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Doctor Chat - Cure Pulse</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(to right, #43cea2, #185a9d);
            color: #333;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
        }

        /* فقاعات متحركة بالخلفية */
        .bubbles {
            position: fixed;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
            top: 0;
            left: 0;
        }

            .bubbles span {
                position: absolute;
                display: block;
                background: rgba(255,255,255,0.3);
                border-radius: 50%;
                animation: bubble 20s linear infinite;
                bottom: -150px;
            }

                .bubbles span:nth-child(1) {
                    left: 10%;
                    width: 40px;
                    height: 40px;
                    animation-delay: 0s;
                }

                .bubbles span:nth-child(2) {
                    left: 20%;
                    width: 20px;
                    height: 20px;
                    animation-delay: 2s;
                    animation-duration: 15s;
                }

                .bubbles span:nth-child(3) {
                    left: 70%;
                    width: 60px;
                    height: 60px;
                    animation-delay: 4s;
                }

                .bubbles span:nth-child(4) {
                    left: 50%;
                    width: 30px;
                    height: 30px;
                    animation-delay: 6s;
                    animation-duration: 12s;
                }

                .bubbles span:nth-child(5) {
                    left: 85%;
                    width: 50px;
                    height: 50px;
                    animation-delay: 8s;
                }

        @@keyframes bubble {
            0%

        {
            transform: translateY(0) scale(1);
        }

        100% {
            transform: translateY(-1000px) scale(0.5);
        }

        }

        .page-container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            min-height: 100vh;
        }

        .chat-container {
            width: 420px;
            max-width: 95%;
            height: 620px;
            max-height: 90vh;
            background: rgba(255, 255, 255, 0.25);
            border-radius: 20px;
            backdrop-filter: blur(20px);
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
            animation: fadeIn 1s ease forwards;
            margin: 0 auto;
        }

        @@keyframes fadeIn {
            from

        {
            opacity: 0;
            transform: scale(0.9);
        }

        to {
            opacity: 1;
            transform: scale(1);
        }

        }

        .chat-header {
            background: rgba(255, 255, 255, 0.3);
            padding: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            font-weight: bold;
            font-size: 20px;
            color: #003366;
            border-bottom: 1px solid #ffffff40;
            flex-shrink: 0;
        }

            .chat-header .logo {
                height: 40px;
                width: auto;
                animation: logoIn 1s ease;
            }

        @@keyframes logoIn {
            from

        {
            transform: translateY(-20px);
            opacity: 0;
        }

        to {
            transform: translateY(0);
            opacity: 1;
        }

        }

        .status-dot {
            width: 10px;
            height: 10px;
            background: #00ff00;
            border-radius: 50%;
            box-shadow: 0 0 5px #00ff00;
        }

        .chat-box {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
            scroll-behavior: smooth;
        }

        .message {
            max-width: 75%;
            padding: 12px 16px;
            border-radius: 18px;
            line-height: 1.5;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            animation: slideIn 0.4s ease forwards;
        }

        .user {
            align-self: flex-end;
            background: #0077cc;
            color: white;
            border-bottom-right-radius: 0;
            flex-direction: row-reverse;
        }

        .doctor {
            align-self: flex-start;
            background: #f9f9f9;
            color: #003366;
            border-bottom-left-radius: 0;
        }

        .message img {
            width: 28px;
            height: 28px;
            flex-shrink: 0;
        }

        .input-box {
            display: flex;
            padding: 12px;
            background: rgba(255, 255, 255, 0.3);
            border-top: 1px solid #ffffff40;
            flex-direction: column;
            flex-shrink: 0;
        }

        .input-row {
            display: flex;
            width: 100%;
        }

        .input-box input {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 10px;
            outline: none;
            font-size: 15px;
            background: rgba(255, 255, 255, 0.8);
        }

        .input-box button {
            background: linear-gradient(45deg, #0077cc, #00aaff);
            color: white;
            border: none;
            padding: 10px 16px;
            margin-left: 10px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
            flex-shrink: 0;
        }

            .input-box button:hover {
                transform: scale(1.05);
                background: linear-gradient(45deg, #005fa3, #0099cc);
            }

        .suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
            justify-content: flex-start;
        }

        .suggestion-chip {
            background: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(0, 119, 204, 0.3);
            border-radius: 16px;
            padding: 6px 12px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

            .suggestion-chip:hover {
                background: rgba(0, 119, 204, 0.2);
                transform: translateY(-2px);
            }

        @@keyframes slideIn {
            from

        {
            opacity: 0;
            transform: translateY(15px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }

        }

        /* تحسينات للجوال */
        @@media (max-width: 480px) {
            .chat-container {
                width: 100%;
                height: 85vh;
                max-width: 100%;
            }

            .chat-header {
                font-size: 18px;
                padding: 12px;
            }

            .message {
                max-width: 85%;
            }

            .suggestions {
                justify-content: center;
            }

            .input-box {
                padding: 10px;
            }

                .input-box button {
                    padding: 10px 12px;
                }
        }
    </style>
</head>
<body>
    <!-- فقاعات الخلفية -->
    <div class="bubbles">
        <span></span>
        <span></span>
        <span></span>
        <span></span>
        <span></span>
    </div>

    <div class="page-container">
        <div class="chat-container">
            <div class="chat-header">
                <img src="https://cdn-icons-png.flaticon.com/512/3710/3710278.png" alt="Care Pulse Logo" class="logo">
                Doctor Chat <div class="status-dot"></div>
            </div>
            <div class="chat-box" id="chatBox">
                <div class="message user">
                    <img src="https://cdn-icons-png.flaticon.com/512/1077/1077012.png" alt="User" />
                    Hello!
                </div>
                <div class="message doctor">
                    <img src="https://cdn-icons-png.flaticon.com/512/3209/3209265.png" alt="Doctor" />
                    Hello! How can I help you today? What symptoms are you experiencing?
                </div>
            </div>
            <div class="input-box">
                <div class="input-row">
                    <input type="text" id="userInput" placeholder="Type your message..." onkeypress="handleKeyPress(event)" />
                    <button onclick="sendMessage()">Send</button>
                </div>
                <div class="suggestions" id="suggestions">
                    <div class="suggestion-chip" onclick="useSuggestion('I have a headache')">Headache</div>
                    <div class="suggestion-chip" onclick="useSuggestion('I have fever')">Fever</div>
                    <div class="suggestion-chip" onclick="useSuggestion('I feel nauseous')">Nausea</div>
                    <div class="suggestion-chip" onclick="useSuggestion('I have a cough')">Cough</div>
                    <div class="suggestion-chip" onclick="useSuggestion('I feel tired')">Fatigue</div>
                    <div class="suggestion-chip" onclick="useSuggestion('My sugar levels are high')">Diabetes</div>
                </div>
            </div>
        </div>
    </div>

    <!-- صوت التنبيه -->
    <audio id="notifySound" src="https://assets.mixkit.co/sfx/preview/mixkit-message-pop-alert-2354.mp3"></audio>

    <script>
        // دالة لإرسال الرسالة
        function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            if (!message) return;

            const chatBox = document.getElementById('chatBox');

            const userMsg = document.createElement('div');
            userMsg.className = 'message user';
            userMsg.innerHTML = `<img src="https://cdn-icons-png.flaticon.com/512/1077/1077012.png" alt="User" /> ${message}`;
            chatBox.appendChild(userMsg);

            input.value = '';
            chatBox.scrollTop = chatBox.scrollHeight;

            setTimeout(() => {
                const doctorMsg = document.createElement('div');
                doctorMsg.className = 'message doctor';
                doctorMsg.innerHTML = `<img src="https://cdn-icons-png.flaticon.com/512/3209/3209265.png" alt="Doctor" /> ${autoReply(message)}`;
                chatBox.appendChild(doctorMsg);
                document.getElementById('notifySound').play();
                chatBox.scrollTop = chatBox.scrollHeight;
            }, 1200);
        }

        // دالة للرد التلقائي بناءً على محتوى الرسالة
        function autoReply(message) {
            message = message.toLowerCase();

            const replies = {
                greeting: [
                    "Hello! How can I help you today? What symptoms are you experiencing?",
                    "Hi there! Please tell me how you're feeling.",
                    "Hey! What can I assist you with today?"
                ],
                headache: [
                    "It might be due to stress or dehydration. Try resting and drinking water.",
                    "Headaches can be tricky—make sure to stay hydrated and get enough rest.",
                    "If your headache persists, consider consulting a physician."
                ],
                fever: [
                    "Make sure to monitor your temperature and stay hydrated. Do you have chills or cough as well?",
                    "Fever can be a sign of infection. Are you experiencing any other symptoms?",
                    "Please rest and drink plenty of fluids. If fever is high, seek medical advice."
                ],
                diabetes: [
                    "Please monitor your blood sugar levels and follow your diet plan strictly.",
                    "Managing your sugar levels is important. Have you checked your latest readings?",
                    "Remember to take your medication and follow your doctor's instructions."
                ],
                medicine: [
                    "I can suggest proper treatment after understanding all your symptoms.",
                    "Please describe your symptoms so I can advise on treatment options.",
                    "Always consult your doctor before starting or stopping any medication."
                ],
                cough: [
                    "Do you have a dry or productive cough? Any other symptoms like fever or shortness of breath?",
                    "Try to rest and stay hydrated. If cough worsens, see a doctor.",
                    "Coughing can be caused by many things. Please monitor your symptoms carefully."
                ],
                fatigue: [
                    "Feeling tired can be a symptom of many conditions. Are you sleeping well?",
                    "Make sure to get enough rest and eat balanced meals.",
                    "If fatigue persists, it’s best to consult your healthcare provider."
                ],
                nausea: [
                    "Nausea can be uncomfortable. Have you eaten anything unusual recently?",
                    "Try to stay hydrated and rest. If nausea continues, see a doctor.",
                    "Let me know if you have any other symptoms like vomiting or dizziness."
                ],
                default: [
                    "Thank you for sharing. Can you describe your symptoms in more detail?",
                    "I'm here to help. Could you please provide more information?",
                    "Please tell me more about how you are feeling."
                ]
            };

            function randomReply(category) {
                const options = replies[category];
                return options[Math.floor(Math.random() * options.length)];
            }

            if (message.includes("hello") || message.includes("hi")) {
                return randomReply("greeting");
            } else if (message.includes("headache") || message.includes("migraine")) {
                return randomReply("headache");
            } else if (message.includes("fever")) {
                return randomReply("fever");
            } else if (message.includes("diabetes") || message.includes("sugar")) {
                return randomReply("diabetes");
            } else if (message.includes("medicine") || message.includes("treatment")) {
                return randomReply("medicine");
            } else if (message.includes("cough")) {
                return randomReply("cough");
            } else if (message.includes("tired") || message.includes("fatigue")) {
                return randomReply("fatigue");
            } else if (message.includes("nausea") || message.includes("sick")) {
                return randomReply("nausea");
            } else {
                return randomReply("default");
            }
        }

        // دالة لاستخدام الاقتراحات
        function useSuggestion(suggestion) {
            document.getElementById('userInput').value = suggestion;
            sendMessage();
        }

        // دالة للتعامل مع الضغط على مفتاح Enter
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        // التأكد من أن الشات في المنتصف عند تحميل الصفحة
        window.addEventListener('load', function() {
            document.querySelector('.page-container').scrollIntoView({
                behavior: 'auto'
            });
        });
    </script>
</body>
</html>